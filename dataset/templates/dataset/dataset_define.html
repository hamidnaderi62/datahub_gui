{% load static %}
<!DOCTYPE html>
<html class="light-style layout-menu-fixed layout-compact" data-assets-path="" data-template="horizontal-menu-template-no-customizer" data-theme="theme-default" dir="rtl" lang="fa">

<head>
    <meta charset="UTF-8"/>
    <meta content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" name="viewport"/>
    <title> صورتحساب - افزودن | Vuexy - قالب مدیریت بوت استرپ</title>
    <meta content="" name="description"/>
    <!-- Favicon -->
    <link href="{% static 'img/favicon/favicon.ico' %}" rel="icon" type="image/x-icon"/>
    <!-- Icons -->
    <link href="{% static 'vendor/fonts/fontawesome.css' %}" rel="stylesheet"/>
    <link href="{% static 'vendor/fonts/tabler-icons.css' %}" rel="stylesheet"/>
    <link href="{% static 'vendor/fonts/flag-icons.css' %}" rel="stylesheet"/>
    <!-- Core CSS -->
    <link  href="{% static 'vendor/css/rtl/core.css' %}" rel="stylesheet"/>
    <link  href="{% static 'vendor/css/rtl/theme-default.css' %}" rel="stylesheet"/>
    <link href="{% static 'css/demo.css" rel="stylesheet' %}"/>
    <!-- Vendors CSS -->
    <link href="{% static 'vendor/libs/node-waves/node-waves.css' %}" rel="stylesheet"/>
    <link href="{% static 'vendor/libs/perfect-scrollbar/perfect-scrollbar.css' %}" rel="stylesheet"/>
    <link href="{% static 'vendor/libs/typeahead-js/typeahead.css' %}" rel="stylesheet"/>
    <link href="{% static 'libs/flatpickr/flatpickr.css' %}" rel="stylesheet"/>
    <!-- Page CSS -->
    <link href="{% static 'vendor/css/pages/app-invoice.css' %}" rel="stylesheet"/>
    <!-- Helpers -->
    <script src="{% static 'vendor/js/helpers.js' %}"></script>

    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="{% static 'js/config.js' %}"></script>
    <!-- Better experience of RTL -->
    <link href="{% static 'css/rtl.css' %}" rel="stylesheet"/>
</head>

<body>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-navbar-full layout-horizontal layout-without-menu">
    <div class="layout-container">
        <!-- Navbar -->
        <!-- / Navbar -->
        <!-- Layout container -->
        <div class="layout-page">
            <!-- Content wrapper -->
            <div class="content-wrapper">
                <!-- Menu -->
                <!-- / Menu -->
                <!-- Content -->
                <div class="container-xxl flex-grow-1 container-p-y">
                    <div class="row invoice-add">
                        <!-- Invoice Add-->
                        <div class="col-lg-12 col-12 mb-lg-0 mb-4">
                            <div class="card invoice-preview-card">
                                <div class="card-body">

                                    <form method="POST" action="generate_metadata" class="source-item pt-4 px-0 px-sm-4">
                                        {% csrf_token %}
                                        <div id="div_container" class="mb-3" data-repeater-list="group-a">
                                            <div class="repeater-wrapper pt-0 pt-md-4" data-repeater-item>
                                                <div class="d-flex border rounded position-relative pe-0">
                                                    <div class="row w-100 p-3">
                                                        <div class="col-md-3 col-12 mb-md-0 mb-3">
                                                            <input class="form-control mb-3" id="col_name" name="col_name" min="3" placeholder="عنوان" type="text"/>
                                                        </div>
                                                        <div class="col-md-3 col-12 mb-md-0 mb-3">
                                                            <select class="form-select mb-3" id="col_dtype" name="col_dtype">
                                                                <option value="Text" selected>Text</option>
                                                                <option value="Number">Number</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-md-6 col-12 mb-md-0 mb-3">
                                                            <textarea id="col_desc" name="col_desc" class="form-control" placeholder="توضیحات" rows="1"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex flex-column align-items-center justify-content-between border-start p-2">
                                                        <i class="ti ti-x cursor-pointer" data-repeater-delete></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row pb-4">
                                            <div class="col-12">
                                                <button class="btn btn-primary" data-repeater-create type="button">افزودن آیتم</button>
                                                <button class="btn btn-primary" type="button" onclick="generateMetaData()">ارسال</button>
                                            </div>
                                        </div>
                                    </form>

                                </div>
                            </div>
                        </div>
                        <!-- /Invoice Add-->
                        <!-- Invoice Actions -->

                        <!-- /Invoice Actions -->
                    </div>
                    <!-- Offcanvas -->
                    <!-- Send Invoice Sidebar -->
                    <!-- /Send Invoice Sidebar -->
                    <!-- /Offcanvas -->
                </div>
                <!--/ Content -->
                <!-- Footer -->
                <!-- / Footer -->
                <div class="content-backdrop fade"></div>
            </div>
            <!--/ Content wrapper -->
        </div>
        <!--/ Layout container -->
    </div>
</div>
<!-- Overlay -->
<div class="layout-overlay layout-menu-toggle"></div>
<!-- Drag Target Area To SlideIn Menu On Small Screens -->
<div class="drag-target"></div>
<!--/ Layout wrapper -->
<!-- Core JS -->
<!-- build:js assets/vendor/js/core.js -->
<script src="{% static 'vendor/libs/jquery/jquery.js' %}"></script>
<script src="{% static 'vendor/libs/popper/popper.js' %}"></script>
<script src="{% static 'vendor/js/bootstrap.js' %}"></script>
<script src="{% static 'vendor/libs/node-waves/node-waves.js' %}"></script>
<script src="{% static 'vendor/libs/perfect-scrollbar/perfect-scrollbar.js' %}"></script>
<script src="{% static 'vendor/libs/hammer/hammer.js' %}"></script>
<script src="{% static 'vendor/libs/i18n/i18n.js' %}"></script>
<script src="{% static 'vendor/libs/typeahead-js/typeahead.js' %}"></script>
<script src="{% static 'vendor/js/menu.js' %}"></script>
<!-- endbuild -->
<!-- Vendors JS -->
<script src="{% static 'libs/jdate/jdate.js' %}"></script>
<script src="{% static 'libs/flatpickr/flatpickr-jalali.js' %}"></script>
<script src="{% static 'libs/flatpickr/l10n/fa.js' %}"></script>
<script src="{% static 'vendor/libs/cleavejs/cleave.js' %}"></script>
<script src="{% static 'vendor/libs/cleavejs/cleave-phone.js' %}"></script>
<script src="{% static 'vendor/libs/jquery-repeater/jquery-repeater.js' %}"></script>
<!-- Main JS -->
<script src="{% static 'js/main.js' %}"></script>
<!-- Page JS -->
<script src="{% static 'js/offcanvas-send-invoice.js' %}"></script>
<script src="{% static 'js/app-invoice-add.js' %}"></script>
<script>
    function generateMetaData()
    {

        //var div_container = document.getElementById("div_container");
        var div_container = document.querySelector('#div_container')
        var rows = div_container.children;

        console.log(rows)
        var cols = []
        for (let i = 0; i < rows.length; i++) {
            if(rows[i].style.display != 'none')
            {
                var name = document.getElementsByName("group-a[" + i + "][col_name]")[0].value
                var dtype = document.getElementsByName("group-a[" + i + "][col_dtype]")[0].value
                var desc = document.getElementsByName("group-a[" + i + "][col_desc]")[0].value
                const col = {'name':name, 'dtype':dtype, 'desc':desc};
                cols.push(col)
            }

        }

        var cols_json = JSON.stringify(cols);
        console.log(cols_json)


    }

</script>

</body>

</html>